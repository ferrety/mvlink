services:
  filemover:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: mvlink
    environment:
      - DISPLAY=${DISPLAY}
    volumes:
      #- /tmp/.X11-unix:/tmp/.X11-unix
      - .:/app
    network_mode: host
    #privileged: true
    stdin_open: true
    tty: true

  build:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: mvlink-build
    volumes:
      - .:/app
    command: /bin/bash -c "qmake6 FileMover.pro && make"
    network_mode: host

  launch:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: mvlink-launch
    environment:
      - DISPLAY=${DISPLAY}
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix
      - .:/app
    network_mode: host
    command: /bin/bash -c "cd /app && ./filemover"
    depends_on:
      - build